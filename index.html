<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>$BULLISH FRIEND</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="background-animation">
        <?php for ($i = 1; $i <= 16; $i++): ?>
        <div class="particle" style="--i: <?= $i ?>"></div>
        <?php endfor; ?>
    </div>

    <!-- Header Section -->
    <header class="sticky-header">
        <h1 class="main-title">$BULLISH FRIEND</h1>
        
        <div class="header-group">
            <div class="token-group">
                <button class="buy-button" onclick="window.open('https://meme.cooking/meme/1254', '_blank')">
                    BUY NOW <i class="fas fa-coins"></i>
                </button>
                <div class="token-address" onclick="copyAddress()">
                    CA: bullish-1254.meme-cooking.near
                    <div class="toast">Copied!</div>
                </div>
            </div>
            
            <div class="social-icons">
                <a href="https://t.me/Bullish_Friends" target="_blank" class="social-icon">
                    <i class="fab fa-telegram"></i>
                </a>
                <a href="https://x.com/bullish_friend" target="_blank" class="social-icon">
                    <i class="fab fa-x-twitter"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Creation Section -->
    <div class="creation-section">
        <span class="creation-text">Created on</span>
        <a href="https://x.com/memedotcooking" target="_blank">
            <img src="src/meme-cooking.webp" alt="Meme Cooking" class="creation-logo">
        </a>
    </div>

    <!-- Unified Meme Gallery -->
    <main class="unified-gallery" id="gallery"></main>

    <!-- Meme Modal -->
    <div class="meme-modal" id="modal">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <div class="modal-content" id="modal-content"></div>
    </div>

    <!-- Powered By Footer -->
    <footer class="powered-by">
        <span>Powered by</span>
        <img src="src/near-logo.webp" alt="NEAR Protocol" class="near-logo">
    </footer>

    <script>
        // Configuration
        const totalImages = 70;
        const totalVideos = 6;

        // Generate Gallery
        function generateGallery() {
            const gallery = document.getElementById('gallery');
            
            // Add images
            for (let i = 1; i <= totalImages; i++) {
                gallery.appendChild(createMediaElement(`memes/${i}.webp`, 'image'));
            }
            
            // Add videos
            for (let i = 1; i <= totalVideos; i++) {
                gallery.appendChild(createMediaElement(`meme%20videos/${i}.webm`, 'video'));
            }
        }

        function createMediaElement(src, type) {
            const container = document.createElement('div');
            container.className = `meme-item ${type}-container`;
            
            if (type === 'image') {
                const img = document.createElement('img');
                img.src = src;
                img.loading = "lazy";
                container.appendChild(img);
            } else {
                const video = document.createElement('video');
                video.innerHTML = `<source src="${src}" type="video/webm">`;
                video.loop = true;
                video.muted = false; // Enable audio
                video.addEventListener('mouseenter', () => {
                    video.play().catch(error => {
                        // Handle autoplay restrictions
                        video.muted = true;
                        video.play();
                    });
                });
                video.addEventListener('mouseleave', () => video.pause());
                container.appendChild(video);
            }

            container.addEventListener('click', () => openModal(src, type));
            return container;
        }

        // Modal Functions
        function openModal(src, type) {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            
            content.innerHTML = type === 'image' 
                ? `<img src="${src}" alt="Fullscreen meme">`
                : `<video controls autoplay><source src="${src}" type="video/webm"></video>`;

            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // Copy Address
        function copyAddress() {
            navigator.clipboard.writeText("bullish-1254.meme-cooking.near");
            showToast();
        }

        function showToast() {
            const toast = document.querySelector('.toast');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', generateGallery);
    </script>
</body>
</html>
